function is_touch_device()
{
    // Checks for existence in all browsers and IE 10/11 & Surface
    return 'ontouchstart' in window || navigator.maxTouchPoints;
}

var all = document.getElementById('show-all');
var items = document.getElementById('items');

// Add value to counter
var count = items.children.length;
var counter = document.getElementById('show-all-count');
counter.innerText = ' (' + count + ')';

// Flickity related
if (!is_touch_device())
{
    var options = {
        cellAlign: 'left',
        freeScroll: true,
        prevNextButtons: false,
        pageDots: false,
        contain: true
    };
    var isFlickity = true;
    var flickity = new Flickity(items, options);
}

// Toggle active states and flickity
all.addEventListener('click', function() {
    this.classList.toggle('active');
    items.classList.toggle('items-columns');

    if (!is_touch_device())
    {
        if (isFlickity) flickity.destroy();
        else flickity = new Flickity(items, options);

        isFlickity = !isFlickity;
    }
});